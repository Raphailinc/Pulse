# Pulse

Мини-соцсеть на Flask с чистым API, безопасными загрузками и современной витриной.

## Что нового
- App factory + конфиги через переменные окружения (`DATABASE_URL`, `SECRET_KEY`), автоматическое создание директорий загрузок.
- Безопасное сохранение изображений (uuid, проверка расширений, лимит 5 МБ) для постов и профилей.
- Обновлённые шаблоны/стили: тёмный UI, поиск по ленте, карточки постов, удобный профиль.
- JSON эндпоинт `/api/posts` и улучшенная пагинация/поиск по ленте.
- Тесты на pytest с SQLite in-memory конфигом.

## Запуск
```bash
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
flask --app manage.py init-db   # создать таблицы
flask --app manage.py run
```

По умолчанию база — `sqlite:///social.db`. Для другой БД задайте `DATABASE_URL`, например:
```bash
export DATABASE_URL="postgresql://user:pass@localhost:5432/pulse"
export SECRET_KEY="replace-me"
```

## Структура
- `app/__init__.py` — фабрика приложения, логин-менеджер, регистрация blueprint.
- `app/models.py` — пользователи, посты, комментарии с каскадным удалением.
- `app/routes.py` — все маршруты, поиск, пагинация, API, загрузка медиа.
- `static/styles.css` — новый UI; `static/uploads/...` — хранилище изображений.
- `templates/` — обновлённые страницы (лента, пост, профиль, auth).
- `tests/` — pytest сценарии регистрация/логин/пост/комментарий.

## Быстрая проверка
- Линт синтаксиса: `python -m py_compile $(find app -name '*.py')`
- Тесты: `pytest`

## Возможности
- Регистрация/авторизация (пароли PBKDF2).
- Создание/редактирование/удаление постов с картинками.
- Комментарии, профиль с загрузкой аватара.
- Поиск и пагинация ленты, JSON выдача постов.
